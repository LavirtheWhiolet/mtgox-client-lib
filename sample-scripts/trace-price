# This script traces close price until interrupted.


class ::Numeric
  
  def to_pt
    self * Rational(1e4)
  end
  
end


old_ticker = ticker
old_close_price = nil
loop do
  # 
  close_price =
    if ticker.buy_price != old_ticker.buy_price then ticker.buy_price
    else ticker.sell_price
    end
  # On first time...
  old_close_price ||= close_price
  # 
  log(
    "Close: #{close_price.to_f} (#{(close_price - old_close_price).to_pt.to_f.to_s_with_plus} pt.)"
  )
  # Next iteration.
  old_close_price = close_price
  old_ticker = ticker
  wait_ticker_change
end
